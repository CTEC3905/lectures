# CTEC3905
<!-- .slide: class="centered" -->

![HTML, CSS, JavaScript logos](html-css-js-500.png)<!-- .element: class="imgBackground" -->

## **Front-End Web Development**

### Lecture 08

===

# STAFF CONTACTS
<!-- .slide: class="crammed smalltext" -->

**Module leader:**

General queries and admin issues:

**Graeme Stuart**: gstuart@dmu.ac.uk

<hr>

**Tutors**

- Labs: **Graeme Stuart**: gstuart@dmu.ac.uk
- Labs: **Fania Raczinski**: fania.raczinski@dmu.ac.uk
- Lectures: **Dave Everitt**: deveritt@dmu.ac.uk

**Tutor contact outside classes is strictly by email**

===


## ONLINE RESOURCES
<!-- .slide: class="left-align" -->

**Codecademy** free courses:

- [Learn HTML](https://www.codecademy.com/learn/learn-html)
- [Learn CSS](https://www.codecademy.com/learn/learn-css)
- [Learn how to build websites](https://www.codecademy.com/learn/paths/learn-how-to-build-websites)
- [Introduction to JavaScript](https://www.codecademy.com/learn/introduction-to-javascript)

===

<!-- JSON -->

# JSON: **01**
<!-- .slide: class="left-align smalltext" -->


a **JavaScript object** can contain any of these: `string`, `number`, `array`, `object`, `boolean` (true|false), `null` plus (unike JSON) **functions** and **comments**…

**JavaScript objects** are the basis of the **JSON data format**:

> JavaScript’s object-literal syntax is so simple, fexible, and concise, it was adapted to become the **dominant standard for client/server communication in the form of JSON**, which is more compact and flexible than the **XML** that it replaced.

— [Programming JavaScript Applications, Eric Elliott](https://www.ebooks.com/1719226/programming-javascript-applications/elliott-eric/)

---

# JSON: **02**
<!-- .slide: class="left-align smalltext" -->

JSON is a **compact plain-text portable data format**, read/writable (**parsed**) in many languages. It can be generated by **databases** as a data API, **translated** into/from (say) XML…

You can **use JSON data from many APIs** that offer **data** from **remote servers**: [news](https://open-platform.theguardian.com/access/), [weather](https://www.metoffice.gov.uk/datapoint), [Wikipedia](https://www.mediawiki.org/wiki/API:Main_page), [game statistics](https://www.programmableweb.com/category/games/apis?category=20098)…

[JSON Placeholder](https://jsonplaceholder.typicode.com/) has some good examples and can be used for development or learning. An **array of objects** is a common format.

For a more in-depth introduction to APIs in general, see [**"What Are APIs and How Do They Work?"** (ProgrammableWeb.com)](https://www.programmableweb.com/api-university/what-are-apis-and-how-do-they-work)

---

# JSON: **03**
<!-- .slide: class="left-align crammed smalltext" -->

The [Discourse forum](https://www.discourse.org/) has a JSON API. See [discussions on this forum](https://discourse.threejs.org/c/discussion)…

![Discourse Three.js forum](https://raw.githubusercontent.com/front-end-materials/images/master/json-api/discourse-three-js-forum.png)

---

# JSON: **04**
<!-- .slide: class="left-align crammed smalltext" -->

…and **add ".json"** [after a URL](https://discourse.threejs.org/c/discussion.json) for the **JSON data** (use a [JSON beautifier](https://beautifier.io/)):

![Discourse Three.js forum JSON](https://raw.githubusercontent.com/front-end-materials/images/master/json-api/discourse-raw-json.png)

---

# JSON: **05**
<!-- .slide: class="left-align crammed smalltext" -->

…or browser plug-in like the [Chrome extension JSONview](https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc)):

![Discourse Three.js forum JSON](https://raw.githubusercontent.com/front-end-materials/images/master/json-api/discourse-three-js-forum-json.png)-->


---

# JSON: **06**
<!-- .slide: class="left-align smalltext smallcode" -->

here, "users" is an **array** of **objects**, so if we fetch this data:

```js
{
  users: [
  {  
    id: 2,  
    username: "fraguada",  
    name: "Luis E. Fraguada",  
    avatar_template: "/user_avatar/discourse.[…].png"
  },
  {
    id: 1956,  
    username: "andreasplesch",  
//... MUCH MORE DATA!
```

…and assign it to a variable `test`, you can get user names with [map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map):

```javascript
test.users.map(u => u.username)
// ["fraguada", "andreasplesch", etc...]
```

---

# JSON **07**
<!-- .slide: class="left-align crammed smalltext smallcode" -->

Rather than the older AJAX method, `fetch`, has **promises** that **wait for a result** and only `.then` **do something**:

```js
let theData;

fetch(data-to-fetch)
  .then( response => {
    // checks the if the response was okay
    console.log(`response: ${response.status}`);
    return response.json();
  })
  .then( data => {
    // check the raw JSON data in the console
    console.log(data);
    // assign it to a variable
    theData = data;
    // and do stuff with the data here
  })
```

[JavaScript Promises: an Introduction (developers.google.com)](https://developers.google.com/web/fundamentals/primers/promises)

DEMO: [Show Star Wars film info from an API](https://front-end-materials.github.io/json-api/api-starwars/)

---

# JSON: **08**
<!-- .slide: class="left-align smalltext smallcode" -->

`asyc/await` offers simpler syntax for (e.g.) a `fetch.then` promise:

you can add `try`… `catch` blocks as a *fallback* in case the **API call fails**:

```js
const getUserAsync = async (name) => {
  try {
    let response = await fetch(`${API_URL}${name}`);
    let data = await response.json();
    return data;
  } catch (err) {
    console.log(err); // or a message to the user
  }
}
```

- [Promises, async/await (javascript.info)](https://javascript.info/async)
- [Why JavaScript Async/Await Is Better Than Plain Promises](https://dev.to/gafi/7-reasons-to-always-use-async-await-over-plain-promises-tutorial-4ej9)

DEMO: [Get GitHub user details from the GitHub API with `async`](https://front-end-materials.github.io/json-api/api-github/)

---

# JSON: **09**
<!-- .slide: class="left-align smalltext smallcode" -->

**JSON has no "parent" or variable assignment**— and is **just data** and starts with an opening `{` or `[`. This example (stored in a website file e.g.  "menu.json") could generate a particular kind of menu:

```js
{
  "id": "file",
  "value": "File",
  "popup": {
    "menuitem": [
      {"label": "New", "url": "/new", "action": "createNewDoc()"},
      {"label": "Open", "url": "/open", "action": "openDoc()"},
      {"label": "Close", "url": "/close", "action": "closeDoc()"}
    ]
  }
}
```

however, **JSON** is **just data**! It *cannot* contain **comments** or **functions** like **JavaScript objects**, so you'd *remove the quotes* from the *function names*

---

# JSON: **10**
<!-- .slide: class="left-align smalltext smallcode" -->

…after getting JSON data from an API, it is assigned to a variable as a **JavaScript object** (e.g. a `const`) to **store the JSON** for use on your website

- [Introducing JSON](http://www.json.org/ "ECMA-404 The JSON Data Interchange Standard")
- [JSON Basics: What You Need to Know](https://www.elated.com/articles/json-basics/)

---

# JSON: **11**
<!-- .slide: class="left-align smalltext" -->

here’s the raw **JSON data** for the [current solar weather](https://services.swpc.noaa.gov/products/geospace/planetary-k-index-dst.json), often used to **predict aurora displays** in the Arctic Circle

![Solar data raw JSON](https://raw.githubusercontent.com/front-end-materials/images/master/json-api/solar-raw-json.png)

---

# JSON: **12**
<!-- .slide: class="left-align crammed smalltext smallcode" -->

[space weather readings are freely available](https://services.swpc.noaa.gov/) from [noaa.gov](https://www.noaa.gov/)—this solar weather data is in a **nested array**, with the first array as a **header row**:

```json
[
  ["time_tag", "planetary_k_index", "dst"],
  [
    "2018-11-13 00:00:00",
    "2.67",
    "-10.2685003"
  ],
  [ // much, much more data...
]
```

- access the first `"time_tag"` date at `[1][0]`
- the `"planetary_k_index"` ([K-index](https://en.wikipedia.org/wiki/K-index)) data (`"2.67"`) at `[1][1]`
- and the "dst" ([disturbance storm time](https://en.wikipedia.org/wiki/Disturbance_storm_time_index)) at `[1][2]`

---

# JSON **13**
<!-- .slide: class="left-align smalltext smallcode" -->

the data is **stored in a variable** called `jsonData`—the `processData` function gets, formats and displays it (`showData` is the ID of the element that shows… the data!)

```js
const processData = () => {
  showData.innerHTML = `
    <strong>Time:</strong> ${ jsonData[1][0] }
    <br><strong>K index:</strong> ${ jsonData[1][1] }
    <br><strong>distance of solar wind:
    </strong> ${ jsonData[1][2] }`;
}

getData.addEventListener("click", processData);
```

abbreviated for clarity. 

---

# JSON **14**
<!-- .slide: class="left-align" -->

- [Get and display live solar data from an API](https://front-end-materials.github.io/json-api/api-solar-data/)
- [download code](https://github.com/front-end-materials/json-api/tree/master/api-solar-data)
- [See the raw data here](https://services.swpc.noaa.gov/products/geospace/planetary-k-index-dst.json)

===

<!-- APIs -->

# API: **01**
<!-- .slide: class="left-align smalltext" -->

**Using APIs in your project**

- [search for an API on programmableweb.com](https://www.programmableweb.com/category/all/apis) that interests you
- **show initiative** by presenting data in an interesting way
- you may need to **run your code** on a **server**
- you often need to apply for an **API key**
- [Google Maps API](https://developers.google.com/maps/documentation/javascript/) now wants your credit card :-(

[What Is an API… Why Does It Matter? (M. Patterson 2015)](https://sproutsocial.com/insights/what-is-an-api/)  
[Find Social media APIs on the web's largest API directory](https://www.programmableweb.com/category/Social/apis)

---

# API: **02**
<!-- .slide: class="left-align crammed smalltext" -->
				
**API Security**

- all **JavaScript is insecure** as it can be read from the browser
- if you store your API key in JavaScript, **anyone can read it**
- **don't worry**—this is **not a problem for your assignment**!

Extra info: **Just getting data** is fine, but if you're **sending new data** *to* an API, *anyone* could use your key, so it has to be secure. Most options store the key on the server or use [OAuth](https://oauth.net/ "An authorization framework enabling a third-party applications to obtain limited access to an HTTP service").

See: [how can you secure a JavaScript application's API calls](https://stackoverflow.com/a/18516778/123033)  
and [Securing API Keys in a JavaScript Single Page App](http://billpatrianakos.me/blog/2016/02/15/securing-api-keys-in-a-javascript-single-page-app/ "Bill Patrianakos, 2016")

---

# API: **02**
<!-- .slide: class="left-align crammed smalltext" -->
		
**Accessing APIs**

- browsers usually only allow access to files from the **same domain**
- you may need a **local server** to access remote JSON files on your computer
- [CORS](https://www.telerik.com/blogs/using-cors-with-all-modern-browsers "Cross-Origin Resource Sharing") allows access from **other domains**

Cross-origin resource sharing (CORS) is often set up by API providers, allowing restricted resources to be requested via **secure cross-domain requests** for data (via https) between browsers and web servers. Modern browsers can use CORS in API containers (`XMLHttpRequest`, `fetch`, `async`) to reduce cross-origin HTTP request risks.

See: [Using CORS](https://www.html5rocks.com/en/tutorials/cors/), 
[CORS (MDN)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS), [CORS in detail (Stack Overflow)](https://stackoverflow.com/a/43881141/123033)

===

# QUESTIONS?

**please ask now…**

No crowding around the podium afterwards!

Talk to Graeme for module-related issues
